<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Star Star</title>
	<script src="jquery-2.0.3.min.js"></script>
	<script>

	    $('document').ready(function() {
		var c=document.getElementById("myCanvas");
		var context=c.getContext("2d");

		var cells = [];


		for(var i=0; i<10; i++){
		    cell = new Object();
		    cell.x = 50+i*5;
		    cell.y = 100+i*8;
		    cells.push(cell);

		}

		//drawCircleAlt(300, 300, 30);

        var centerX = 500;
        var centerY = 500;

        var curCol = "red";

        var sz = 5;
        for(var i = -sz; i <= sz; i++){
            for(var j = -sz; j <= sz; j++){
                for(var k = -sz; k <= sz; k++){
                    if(i + j + k == 0){
                        if (Math.max(Math.abs(i), Math.abs(j), Math.abs(k)) % 2 == 0){
                            context.fillStyle="red";
                        } else {
                            context.fillStyle="blue";
                        }
                        drawCell(i, j, k, 20);
                        //context.fill();
                    }
                }
            }
        }
        context.fillStyle="green";
        drawCell(0, 0, 0, 20);
        context.fill();

        c.addEventListener('click', function(e){
            //drawHex(e.offsetX, e.offsetY, 30);
            toggleHex(e.offsetX-centerX, e.offsetY-centerY, 20);
        }, false);

        function toggleHex(xPos, yPos, size){
            var x = ((1/3)*Math.sqrt(3)*xPos - (1/3)*yPos) / size;
            var z = (2/3)*yPos/size
            var y = -x-z;

            rx = Math.round(x);
            ry = Math.round(y);
            rz = Math.round(z);

            x_diff = Math.abs(rx - x);
            y_diff = Math.abs(ry - y);
            z_diff = Math.abs(rz - z);

            if (x_diff>y_diff && x_diff > z_diff){
                rx = -ry-rz;
            } else if (y_diff > z_diff){
                ry = -rx-rz;
            } else {
                rz = -rx-ry;
            }


            if(Math.max(Math.abs(rx), Math.abs(ry), Math.abs(rz)) <= sz){
                context.fillStyle=curCol;
                drawCell(rx, ry, rz, size);
                context.fill();
                if(curCol == "red"){
                    curCol = "blue";
                } else {
                    curCol = "red";
                }
            }

        }

        function drawCell(x, y, z, size){
            drawHex(centerX+size*Math.sqrt(3)*(x+z/2), centerY+(3/2)*z*size, size);
        }

		function drawHex(x, y, size){
		    context.beginPath();

		    context.moveTo(x, y+size);
		    for(var i=1; i<6; i++){
                xp = x + size*Math.sin(i*Math.PI*2/6);
                yp = y + size*Math.cos(i*Math.PI*2/6);
                context.lineTo(xp, yp);
		    }
		    context.closePath();
            context.stokeStyle="red";
		    context.stroke();
		}

	    });

	</script>
    </head>
    <body>
        <h1>Star</h1>
	<canvas id="myCanvas" width="1000" height="1000"> </canvas>
	
    </body>
</html>
